<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Prefix Product | Chengyu Zhang</title>
<meta name="keywords" content="Data Structures and Algorithms (DSA)">
<meta name="description" content="A powerful technique for efficiently computing product-related queries.">
<meta name="author" content="Chengyu Zhang">
<link rel="canonical" href="https://gnehcuyz.github.io/posts/PrefixProduct/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        {left: '\\[', right: '\\]', display: true},   
        {left: '$$', right: '$$', display: true},     
        {left: '\\(', right: '\\)', display: false},  
      ],
      throwOnError : false
    });
  });
</script>
  
<link rel="icon" href="https://gnehcuyz.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://gnehcuyz.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://gnehcuyz.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://gnehcuyz.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://gnehcuyz.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://gnehcuyz.github.io/posts/PrefixProduct/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://gnehcuyz.github.io/posts/PrefixProduct/">
  <meta property="og:site_name" content="Chengyu Zhang">
  <meta property="og:title" content="Prefix Product">
  <meta property="og:description" content="A powerful technique for efficiently computing product-related queries.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-03-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-03-01T00:00:00+00:00">
    <meta property="article:tag" content="Data Structures and Algorithms (DSA)">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Prefix Product">
<meta name="twitter:description" content="A powerful technique for efficiently computing product-related queries.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://gnehcuyz.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Prefix Product",
      "item": "https://gnehcuyz.github.io/posts/PrefixProduct/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Prefix Product",
  "name": "Prefix Product",
  "description": "A powerful technique for efficiently computing product-related queries.",
  "keywords": [
    "Data Structures and Algorithms (DSA)"
  ],
  "articleBody": "What is Prefix Product? Prefix Product is a technique used to precompute cumulative products in an array, allowing product-related queries to be answered efficiently.\nHow to Construct a Prefix Product Array Steps: Initialize an array prefix of the same size as the input array.\nCompute cumulative products:\n\\[ \\text{prefix}[i] = \\text{prefix}[i-1] \\cdot arr[i] \\] Use prefix products for efficient range queries:\n\\[ \\text{Product}(l, r) = \\frac{\\text{prefix}[r]}{\\text{prefix}[l-1]} \\quad \\text{if} \\hspace{0.2cm} l \u003e 0 \\]If \\( l = 0 \\), then \\( \\text{Product}(0, r) = \\text{prefix}[r] \\).\nExample arr = [2, 3, 4, 5] prefix = [2, 6, 24, 120] # Precomputed product array prefix[2] = 2 × 3 × 4 = 24 prefix[3] = 2 × 3 × 4 × 5 = 120 Efficient Query Example: Find product from index 1 to 3:\nProduct(1,3) = prefix[3] / prefix[0] = 120 / 2 = 60 Implementation of Prefix Product def prefix_product(arr): n = len(arr) prefix = [1] * n prefix[0] = arr[0] for i in range(1, n): prefix[i] = prefix[i-1] * arr[i] return prefix def range_product(prefix, l, r): if l == 0: return prefix[r] return prefix[r] // prefix[l-1] # Example usage arr = [2, 3, 4, 5] prefix = prefix_product(arr) # Product from index 1 to 3 print(range_product(prefix, 1, 3)) # Output: 60 Time and Space Complexity Time Complexity Preprocessing step: Constructing the prefix product array takes O(N) time since each element is computed once. Querying a range product: Once the prefix product array is built, each query runs in O(1) time since it only involves a simple division. Space Complexity If storing the prefix product separately, it requires an additional O(N) space. If the input array itself is modified to store prefix products, the space complexity is O(1). Classic LeetCode Problems Product of Array Except Self Range Product Query Subarray Product Less Than K ",
  "wordCount" : "303",
  "inLanguage": "en",
  "datePublished": "2025-03-01T00:00:00Z",
  "dateModified": "2025-03-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Chengyu Zhang"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://gnehcuyz.github.io/posts/PrefixProduct/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Chengyu Zhang",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gnehcuyz.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://gnehcuyz.github.io/" accesskey="h" title="Chengyu Zhang (Alt + H)">Chengyu Zhang</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://gnehcuyz.github.io/about/" title="About me">
                    <span>About me</span>
                </a>
            </li>
            <li>
                <a href="https://gnehcuyz.github.io/experience" title="Experience">
                    <span>Experience</span>
                </a>
            </li>
            <li>
                <a href="https://gnehcuyz.github.io/research/" title="Research">
                    <span>Research</span>
                </a>
            </li>
            <li>
                <a href="https://gnehcuyz.github.io/publications/" title="Publications">
                    <span>Publications</span>
                </a>
            </li>
            <li>
                <a href="https://gnehcuyz.github.io/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://gnehcuyz.github.io/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://gnehcuyz.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://gnehcuyz.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://gnehcuyz.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Prefix Product
    </h1>
    <div class="post-meta"><span title='2025-03-01 00:00:00 +0000 UTC'>March 1, 2025</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Chengyu Zhang

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#what-is-prefix-product" aria-label="What is Prefix Product?">What is Prefix Product?</a></li>
                <li>
                    <a href="#how-to-construct-a-prefix-product-array" aria-label="How to Construct a Prefix Product Array">How to Construct a Prefix Product Array</a><ul>
                        <ul>
                        
                <li>
                    <a href="#steps" aria-label="Steps:">Steps:</a></li>
                <li>
                    <a href="#example" aria-label="Example">Example</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#implementation-of-prefix-product" aria-label="Implementation of Prefix Product">Implementation of Prefix Product</a></li>
                <li>
                    <a href="#time-and-space-complexity" aria-label="Time and Space Complexity">Time and Space Complexity</a><ul>
                        <ul>
                        
                <li>
                    <a href="#time-complexity" aria-label="Time Complexity">Time Complexity</a></li>
                <li>
                    <a href="#space-complexity" aria-label="Space Complexity">Space Complexity</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#classic-leetcode-problems" aria-label="Classic LeetCode Problems">Classic LeetCode Problems</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="what-is-prefix-product"><strong>What is Prefix Product?</strong><a hidden class="anchor" aria-hidden="true" href="#what-is-prefix-product">#</a></h1>
<p>Prefix Product is a technique used to <strong>precompute cumulative products</strong> in an array, allowing product-related queries to be answered efficiently.</p>
<hr>
<h1 id="how-to-construct-a-prefix-product-array"><strong>How to Construct a Prefix Product Array</strong><a hidden class="anchor" aria-hidden="true" href="#how-to-construct-a-prefix-product-array">#</a></h1>
<h3 id="steps"><strong>Steps:</strong><a hidden class="anchor" aria-hidden="true" href="#steps">#</a></h3>
<ol>
<li>
<p><strong>Initialize an array <code>prefix</code></strong> of the same size as the input array.</p>
</li>
<li>
<p><strong>Compute cumulative products:</strong></p>
\[
   	\text{prefix}[i] = 	\text{prefix}[i-1] \cdot arr[i]
   \]</li>
<li>
<p><strong>Use prefix products for efficient range queries:</strong></p>
\[
    \text{Product}(l, r) = \frac{\text{prefix}[r]}{\text{prefix}[l-1]} \quad \text{if} \hspace{0.2cm} l > 0 
   \]<p>If \( l = 0 \), then \( 	\text{Product}(0, r) =  \text{prefix}[r] \).</p>
</li>
</ol>
<h3 id="example"><strong>Example</strong><a hidden class="anchor" aria-hidden="true" href="#example">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>arr <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]
</span></span><span style="display:flex;"><span>prefix <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">120</span>]  <span style="color:#75715e"># Precomputed product array</span>
</span></span></code></pre></div><ul>
<li><code>prefix[2] = 2 × 3 × 4 = 24</code></li>
<li><code>prefix[3] = 2 × 3 × 4 × 5 = 120</code></li>
</ul>
<p><strong>Efficient Query Example:</strong>
Find product from index <strong>1 to 3</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Product(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> prefix[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">/</span> prefix[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">120</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>
</span></span></code></pre></div><hr>
<h1 id="implementation-of-prefix-product"><strong>Implementation of Prefix Product</strong><a hidden class="anchor" aria-hidden="true" href="#implementation-of-prefix-product">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prefix_product</span>(arr):
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> len(arr)
</span></span><span style="display:flex;"><span>    prefix <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> n
</span></span><span style="display:flex;"><span>    prefix[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> arr[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, n):
</span></span><span style="display:flex;"><span>        prefix[i] <span style="color:#f92672">=</span> prefix[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> arr[i]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prefix
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">range_product</span>(prefix, l, r):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> l <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> prefix[r]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prefix[r] <span style="color:#f92672">//</span> prefix[l<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Example usage</span>
</span></span><span style="display:flex;"><span>arr <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]
</span></span><span style="display:flex;"><span>prefix <span style="color:#f92672">=</span> prefix_product(arr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Product from index 1 to 3</span>
</span></span><span style="display:flex;"><span>print(range_product(prefix, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>))  <span style="color:#75715e"># Output: 60</span>
</span></span></code></pre></div><hr>
<h1 id="time-and-space-complexity"><strong>Time and Space Complexity</strong><a hidden class="anchor" aria-hidden="true" href="#time-and-space-complexity">#</a></h1>
<h3 id="time-complexity"><strong>Time Complexity</strong><a hidden class="anchor" aria-hidden="true" href="#time-complexity">#</a></h3>
<ul>
<li><strong>Preprocessing step:</strong> Constructing the prefix product array takes <strong>O(N)</strong> time since each element is computed once.</li>
<li><strong>Querying a range product:</strong> Once the prefix product array is built, each query runs in <strong>O(1)</strong> time since it only involves a simple division.</li>
</ul>
<h3 id="space-complexity"><strong>Space Complexity</strong><a hidden class="anchor" aria-hidden="true" href="#space-complexity">#</a></h3>
<ul>
<li>If storing the prefix product separately, it requires an additional <strong>O(N)</strong> space.</li>
<li>If the input array itself is modified to store prefix products, the space complexity is <strong>O(1)</strong>.</li>
</ul>
<hr>
<h1 id="classic-leetcode-problems"><strong>Classic LeetCode Problems</strong><a hidden class="anchor" aria-hidden="true" href="#classic-leetcode-problems">#</a></h1>
<ul>
<li><a href="https://leetcode.com/problems/product-of-array-except-self/">Product of Array Except Self</a></li>
<li><a href="https://leetcode.com/problems/range-product-query/">Range Product Query</a></li>
<li><a href="https://leetcode.com/problems/subarray-product-less-than-k/">Subarray Product Less Than K</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://gnehcuyz.github.io/tags/Data-Structures-and-Algorithms-DSA/">Data Structures and Algorithms (DSA)</a></li>
    </ul>
  </footer>
</article>
    </main>
    <footer style="text-align: center; padding: 1rem 0; font-size: 0.9rem;">
    <p>
        Last updated on 2025-05-23 ||
        &copy; 2025 
        <a href="https://yourwebsite.com" style="text-decoration: underline;">Chengyu Zhang</a> ||
        Powered by 
        <a href="https://gohugo.io/" style="text-decoration: underline;">Hugo</a> & 
        <a href="https://themes.gohugo.io/themes/hugo-papermod/" style="text-decoration: underline;">PaperMod</a>
    </p>
</footer>
</body>

</html>
